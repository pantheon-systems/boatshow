langcode: en
status: true
dependencies: {  }
id: business
class: null
field_plugin_method: null
cck_plugin_method: null
migration_tags: null
migration_group: discoverboating_com
label: 'Importing business from DiscoverBoating.com.'
source:
  plugin: csv
  path: ./modules/custom/nmma_migrate/csv/business.csv
  # The number of rows at the beginning which are not data.
  header_row_count: 1
  # These are the field names from the source file representing the key
  # uniquely identifying each game - they will be stored in the migration
  # map table as columns sourceid1, sourceid2, and sourceid3.
  keys:
    - Id
  # Here we identify the columns of interest in the source file. Each numeric
  # key is the 0-based index of the column. For each column, the key below
  # (e.g., "start_date") is the field name assigned to the data on import, to
  # be used in field mappings below. The value is a user-friendly string for
  # display by the migration UI.
  column_names:
    # So, here we're saying that the first field (index 0) on each line will
    # be stored in the start_date field in the Row object during migration, and
    # that name can be used to map the value below. "Date of game" will appear
    # in the UI to describe this field.
    0:
      Id: Id
    1:
      StatusId: StatusId
    2:
      OfficialName: OfficialName
    3:
      DisplayName: DisplayName
    4:
      TrimmedName: TrimmedName
    5:
      ShortDescription: ShortDescription
    6:
      Description: Description
    7:
      DUNS: DUNS
    8:
      MIC: MIC
    9:
      PrimaryContactId: PrimaryContactId
    10:
      PrimaryWeb: PrimaryWeb
    11:
      PrimaryPhone: PrimaryPhone
    12:
      PrimaryFax: PrimaryFax
    13:
      PrimaryAddressId: PrimaryAddressId
    14:
      ImageName: ImageName
    15:
      PreferredContactMethod: PreferredContactMethod
    16:
      AllowEmail: AllowEmail
    17:
      AllowPhone: AllowPhone
    18:
      AllowFax: AllowFax
    19:
      AllowMail: AllowMail
    20:
      CreatedOn: CreatedOn
    21:
      CreatedBy: CreatedBy
    22:
      AssessmentType: AssessmentType
    23:
      IsCertified: IsCertified
    24:
      DeletedOn: DeletedOn
    25:
      DeletedBy: DeletedBy
    26:
      Name: Name
    27:
      Address: Address
    28:
      Address2: Address2
    29:
      City: City
    30:
      PostalCode: PostalCode
    31:
      Lat: Lat
    32:
      Lng: Lng
    33:
      State: State
    34:
      Country: Country
    35:
      Certified: Certified
    36:
      AccountTypes: AccountTypes
    37:
      Brands: Brands
  constants:
    bool_0: 0
    bool_1: 1
    uid_root: 1
process:
  # Most fields can be mapped directly - we just specify the destination (D8)
  # field and the corresponding field name from above, and the values will be
  # copied in.
  sticky: constants/bool_0
  promote: constants/bool_0
  uid: constants/uid_root
  title: OfficialName
  field_bus_nmma_id: Id
  field_bus_address/country_code: Country
  field_bus_address/langcode:
    plugin: default_value
    default_value: en
  field_bus_address/address_line1: Address
  field_bus_address/address_line2: Address2
  field_bus_address/locality: City
  field_bus_address/administrative_area: State
  field_bus_address/postal_code: PostalCode
  field_bus_map_data/lat: Lat
  field_bus_map_data/lng: Lng
  field_bus_allow_email: AllowEmail
  field_bus_allow_fax: AllowFax
  field_bus_allow_mail: AllowMail
  field_bus_allow_phone: AllowPhone
  field_bus_body: ShortDescription
  field_bus_display_name: DisplayName
  field_bus_phone: PrimaryPhone
  field_bus_is_certified: Certified
  field_bus_type:
    -
      plugin: explode
      source: AccountTypes
      delimiter: ';'
#  field_bus_brands:
#    -
#      plugin: explode
#      source: Brands
#      delimiter: ';'
#    -
#      plugin: migration_lookup
#      migration: brands_en
#      no_stub: true
  field_bus_url:
    -
      source: PrimaryWeb
      plugin: callback
      callable: 'nmma_migrate_link_create'
    -
      plugin: field_link
      uri_scheme: 'http://'
  status:
    plugin: static_map
    source:
      - StatusId
    map:
      1: 1
      # There is only 1 or 3 in their data, as far as i could tell, 3 is un-published.
      3: 0
  langcode:
    plugin: default_value
    default_value: en
destination:
  plugin: 'entity:node'
  default_bundle: business
#migration_dependencies:
#  required:
#    - brands_en
